<div class="task-table-wrapper">
  <table mat-table matSort [dataSource]="tasks()" class="task-table" aria-label="Task list">
    <!-- Title Column -->
    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef mat-sort-header scope="col">Title</th>
      <td mat-cell *matCellDef="let task">
        <span class="task-table__title">{{ task.title }}</span>
      </td>
    </ng-container>

    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef mat-sort-header scope="col">Status</th>
      <td mat-cell *matCellDef="let task">
        <span class="task-table__status task-table__status--{{ task.status }}">
          {{ task.status | taskStatus }}
        </span>
      </td>
    </ng-container>

    <!-- Priority Column -->
    <ng-container matColumnDef="priority">
      <th mat-header-cell *matHeaderCellDef mat-sort-header scope="col">Priority</th>
      <td mat-cell *matCellDef="let task">
        <span class="task-table__priority task-table__priority--{{ task.priority }}">
          {{ task.priority | priorityLabel }}
        </span>
      </td>
    </ng-container>

    <!-- Assignee Column -->
    <ng-container matColumnDef="assigneeId">
      <th mat-header-cell *matHeaderCellDef scope="col">Assignee</th>
      <td mat-cell *matCellDef="let task">
        {{ task.assigneeId ?? '—' }}
      </td>
    </ng-container>

    <!-- Due Date Column -->
    <ng-container matColumnDef="dueDate">
      <th mat-header-cell *matHeaderCellDef mat-sort-header scope="col">Due Date</th>
      <td mat-cell *matCellDef="let task">
        {{ task.dueDate ? (task.dueDate | date: 'mediumDate') : '—' }}
      </td>
    </ng-container>

    <!-- Actions Column -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef scope="col">Actions</th>
      <td mat-cell *matCellDef="let task">
        <button
          class="task-table__action-btn"
          aria-label="View task details"
          (click)="onRowClick(task); $event.stopPropagation()"
        >
          <mat-icon>open_in_new</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr
      mat-row
      *matRowDef="let task; columns: displayedColumns"
      class="task-table__row"
      (click)="onRowClick(task)"
      [attr.aria-label]="'View task: ' + task.title"
      tabindex="0"
      (keydown.enter)="onRowClick(task)"
    ></tr>
  </table>

  <mat-paginator
    [length]="total()"
    [pageSize]="pageSize()"
    [pageIndex]="currentPage() - 1"
    [pageSizeOptions]="[10, 25, 50]"
    (page)="onPageEvent($event)"
    aria-label="Task list pagination"
  />
</div>
